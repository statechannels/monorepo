## API Report File for "@statechannels/server-wallet"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

import { Address } from '@statechannels/wallet-core';
import { AllocationItem } from '@statechannels/nitro-protocol';
import { AllocationItem as AllocationItem_2 } from '@statechannels/wallet-core';
import { AssetOutcome } from '@statechannels/nitro-protocol';
import { ChannelConstants } from '@statechannels/wallet-core';
import { ChannelId } from '@statechannels/client-api-schema';
import { ChannelResult } from '@statechannels/client-api-schema';
import { CloseChannel } from '@statechannels/wallet-core';
import { CloseChannelParams } from '@statechannels/client-api-schema';
import { Config } from 'knex';
import { CreateChannelParams } from '@statechannels/client-api-schema';
import { DefundChannel } from '@statechannels/wallet-core';
import { Destination } from '@statechannels/wallet-core';
import { ethers } from 'ethers';
import EventEmitter from 'eventemitter3';
import { FundingStatus } from '@statechannels/client-api-schema';
import { FundingStrategy } from '@statechannels/client-api-schema';
import { GetStateParams } from '@statechannels/client-api-schema';
import { JoinChannelParams } from '@statechannels/client-api-schema';
import { JSONSchema } from 'objection';
import Knex from 'knex';
import { Level } from 'pino';
import { Logger } from 'pino';
import { Payload as Message } from '@statechannels/wallet-core';
import { Message as Message_2 } from '@statechannels/wire-format';
import { Message as Message_3 } from '@statechannels/client-api-schema';
import { MessageQueuedNotification } from '@statechannels/client-api-schema';
import { Model } from 'objection';
import { ModelOptions } from 'objection';
import { OpenChannel } from '@statechannels/wallet-core';
import { Outcome } from '@statechannels/wallet-core';
import { Participant } from '@statechannels/wallet-core';
import { Participant as Participant_2 } from '@statechannels/client-api-schema';
import { Payload } from '@statechannels/wire-format';
import { Pojo } from 'objection';
import { PrivateKey } from '@statechannels/wallet-core';
import { providers } from 'ethers';
import { QueryContext } from 'objection';
import { SignatureEntry } from '@statechannels/wallet-core';
import { SignedState } from '@statechannels/wallet-core';
import { SignedState as SignedState_2 } from '@statechannels/wire-format';
import { SignedStateVarsWithHash } from '@statechannels/wallet-core';
import { SignedStateWithHash } from '@statechannels/wallet-core';
import { SimpleAllocation } from '@statechannels/wallet-core';
import { State } from '@statechannels/wallet-core';
import { StateVariables } from '@statechannels/wallet-core';
import { StateWithHash } from '@statechannels/wallet-core';
import { SubmitChallenge } from '@statechannels/wallet-core';
import { SyncChannelParams } from '@statechannels/client-api-schema';
import { Transaction } from 'objection';
import { TransactionOrKnex } from 'objection';
import { Uint256 } from '@statechannels/wallet-core';
import { UpdateChannelParams } from '@statechannels/client-api-schema';
import { ValidationErrorItem } from 'joi';

// Warning: (ae-forgotten-export) The symbol "ChainServiceArgs" needs to be exported by the entry point index.d.ts
//
// @public
export type ChainServiceConfiguration = {
    attachChainService: boolean;
} & Partial<Exclude<ChainServiceArgs, 'logger'>>;

// @public
export type DatabaseConfiguration = RequiredDatabaseConfiguration & OptionalDatabaseConfiguration;

// @public
export type DatabaseConnectionConfiguration = RequiredConnectionConfiguration & Partial<OptionalConnectionConfiguration>;

// @public
export type DatabasePoolConfiguration = {
    max?: number;
    min?: number;
};

// @public
export class DBAdmin {
    static createDatabase(config: IncomingEngineConfig): Promise<void>;
    static createDatabaseFromKnex(knex: Knex): Promise<void>;
    static dropDatabase(config: IncomingEngineConfig): Promise<void>;
    static dropDatabaseFromKnex(knex: Knex): Promise<void>;
    static migrateDatabase(config: IncomingEngineConfig): Promise<void>;
    static migrateDatabaseFromKnex(knex: Knex): Promise<void>;
    static truncateDatabase(config: IncomingEngineConfig, tables?: string[]): Promise<void>;
    static truncateDataBaseFromKnex(knex: Knex, tables?: string[]): Promise<void>;
}

// @public (undocumented)
export type DeepPartial<T> = {
    [P in keyof T]?: DeepPartial<T[P]>;
};

// @public (undocumented)
export const DEFAULT_DB_NAME = "server_wallet_test";

// @public (undocumented)
export const DEFAULT_DB_USER = "postgres";

// @public (undocumented)
export const defaultChainServiceConfiguration: ChainServiceConfiguration;

// @public
export const defaultConfig: OptionalEngineConfig;

// @public (undocumented)
export const defaultDatabaseConfiguration: OptionalDatabaseConfiguration & {
    connection: {
        host: string;
        port: number;
        user: string;
    };
};

// @public
export const defaultLoggingConfiguration: LoggingConfiguration;

// @public (undocumented)
export const defaultMetricsConfiguration: {
    timingMetrics: boolean;
};

// Warning: (ae-forgotten-export) The symbol "HasDatabaseConnectionConfigObject" needs to be exported by the entry point index.d.ts
//
// @public (undocumented)
export const defaultTestConfig: (partialConfig?: DeepPartial<EngineConfig & HasDatabaseConnectionConfigObject>) => EngineConfig & HasDatabaseConnectionConfigObject;

// @public (undocumented)
export const defaultTestNetworkConfiguration: NetworkConfiguration;

// @public
export abstract class Engine extends SingleThreadedEngine implements EngineInterface {
    // (undocumented)
    static create(engineConfig: IncomingEngineConfig): Promise<SingleThreadedEngine | MultiThreadedEngine>;
}

// @public
export type EngineConfig = RequiredEngineConfig & OptionalEngineConfig;

// Warning: (ae-forgotten-export) The symbol "ChannelUpdatedEvent" needs to be exported by the entry point index.d.ts
//
// @public (undocumented)
export type EngineEvent = ChannelUpdatedEvent;

// @public (undocumented)
export interface EngineInterface {
    // (undocumented)
    challenge(channelId: string): Promise<SingleChannelOutput>;
    // (undocumented)
    closeChannel(args: CloseChannelParams): Promise<SingleChannelOutput>;
    // (undocumented)
    createChannels(args: CreateChannelParams, numberOfChannels: number): Promise<MultipleChannelOutput>;
    // (undocumented)
    getChannels(): Promise<MultipleChannelOutput>;
    // (undocumented)
    getState(args: GetStateParams): Promise<SingleChannelOutput>;
    // (undocumented)
    joinChannels(channelIds: ChannelId[]): Promise<MultipleChannelOutput>;
    // (undocumented)
    pushMessage(m: unknown): Promise<MultipleChannelOutput>;
    // (undocumented)
    pushUpdate(m: unknown): Promise<SingleChannelOutput>;
    // (undocumented)
    registerAppBytecode(appDefinition: string, bytecode: string): Promise<void>;
    // (undocumented)
    registerAppDefinition(appDefinition: string): Promise<void>;
    // (undocumented)
    syncChannel(args: SyncChannelParams): Promise<SingleChannelOutput>;
    // Warning: (ae-forgotten-export) The symbol "Bytes32" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    syncChannels(chanelIds: Bytes32[]): Promise<MultipleChannelOutput>;
    // (undocumented)
    updateChannel(args: UpdateChannelParams): Promise<SingleChannelOutput>;
}

// @public (undocumented)
export type EnsureObjectiveFailed = {
    type: 'EnsureObjectiveFailed';
    numberOfAttempts: number;
};

// @public (undocumented)
export function extractDBConfigFromEngineConfig(engineConfig: EngineConfig): Config;

// Warning: (ae-forgotten-export) The symbol "DatabaseConnectionConfigObject" needs to be exported by the entry point index.d.ts
//
// @public (undocumented)
export function getDatabaseConnectionConfig(config: EngineConfig): DatabaseConnectionConfigObject & {
    host: string;
    port: number;
};

// @public (undocumented)
export function hasNewObjective(response: SingleChannelOutput): response is SingleChannelOutput & {
    newObjective: WalletObjective;
};

// @public
export type IncomingEngineConfig = RequiredEngineConfig & Partial<OptionalEngineConfig>;

// @public
export type InternalError = {
    type: 'InternalError';
    error: Error;
};

// @public
export type LoggingConfiguration = {
    logLevel: Level;
    logDestination: string;
};

export { Message }

// @public
export type MetricsConfiguration = {
    timingMetrics: boolean;
    metricsOutputFile?: string;
};

// @public (undocumented)
export type MultipleChannelOutput = {
    outbox: Outgoing[];
    channelResults: ChannelResult[];
    newObjectives: WalletObjective[];
    messagesByObjective: Record<string, WireMessage[]>;
};

// @public
export class MultiThreadedEngine extends SingleThreadedEngine {
    protected constructor(engineConfig: IncomingEngineConfig);
    // (undocumented)
    static create(engineConfig: IncomingEngineConfig): Promise<MultiThreadedEngine>;
    // (undocumented)
    destroy(): Promise<void>;
    // (undocumented)
    pushMessage(rawPayload: unknown): Promise<MultipleChannelOutput>;
    // (undocumented)
    pushUpdate(rawPayload: unknown): Promise<SingleChannelOutput>;
    // (undocumented)
    updateChannel(args: UpdateChannelParams): Promise<SingleChannelOutput>;
    // (undocumented)
    warmUpThreads(): Promise<void>;
    }

// @public
export type NetworkConfiguration = {
    chainNetworkID: number;
};

// @public (undocumented)
export type ObjectiveDoneResult = ObjectiveSuccess | ObjectiveError;

// @public (undocumented)
export type ObjectiveError = EnsureObjectiveFailed | InternalError;

// @public (undocumented)
export type ObjectiveProposed = {
    ObjectiveProposed: WalletObjective;
};

// @public
export type ObjectiveResult = {
    done: Promise<ObjectiveDoneResult>;
    currentStatus: ObjectiveStatus;
    objectiveId: string;
    channelId: string;
};

// @public (undocumented)
export type ObjectiveSuccess = {
    channelId: string;
    type: 'Success';
};

// @public
export type OptionalConnectionConfiguration = {
    port: number;
} | string;

// @public (undocumented)
export type OptionalDatabaseConfiguration = {
    pool?: DatabasePoolConfiguration;
    debug?: boolean;
    connection: OptionalConnectionConfiguration;
};

// @public
export interface OptionalEngineConfig {
    // (undocumented)
    chainServiceConfiguration: ChainServiceConfiguration;
    // (undocumented)
    databaseConfiguration: OptionalDatabaseConfiguration;
    // (undocumented)
    loggingConfiguration: LoggingConfiguration;
    // (undocumented)
    metricsConfiguration: MetricsConfiguration;
    // (undocumented)
    skipEvmValidation: boolean;
    // (undocumented)
    workerThreadAmount: number;
}

// Warning: (ae-forgotten-export) The symbol "Notice" needs to be exported by the entry point index.d.ts
//
// @public (undocumented)
export type Outgoing = Notice;

// @public (undocumented)
export type Output = SingleChannelOutput | MultipleChannelOutput;

// Warning: (ae-forgotten-export) The symbol "PartialConfigObject" needs to be exported by the entry point index.d.ts
//
// @public (undocumented)
export function overwriteConfigWithDatabaseConnection(config: EngineConfig, databaseConnectionConfig: PartialConfigObject | string): EngineConfig;

// @public
export type RequiredConnectionConfiguration = {
    database: string;
    host: string;
    user: string;
    password?: string;
} | string;

// @public
export type RequiredDatabaseConfiguration = {
    connection: RequiredConnectionConfiguration;
};

// @public
export type RequiredEngineConfig = {
    databaseConfiguration: RequiredDatabaseConfiguration;
    networkConfiguration: NetworkConfiguration;
};

// @public (undocumented)
export type RetryOptions = {
    numberOfAttempts: number;
    initialDelay: number;
    multiple: number;
};

// @public (undocumented)
export type SingleChannelOutput = {
    outbox: Outgoing[];
    channelResult: ChannelResult;
    newObjective: WalletObjective | undefined;
};

// Warning: (ae-forgotten-export) The symbol "EventEmitterType" needs to be exported by the entry point index.d.ts
// Warning: (ae-forgotten-export) The symbol "ChainEventSubscriberInterface" needs to be exported by the entry point index.d.ts
//
// @public
export class SingleThreadedEngine extends EventEmitter<EventEmitterType> implements EngineInterface, ChainEventSubscriberInterface {
    protected constructor(engineConfig: IncomingEngineConfig);
    addSigningKey(privateKey: PrivateKey): Promise<void>;
    // (undocumented)
    approveObjectives(objectiveIds: string[]): Promise<{
        objectives: WalletObjective[];
        messages: Message_3[];
    }>;
    // Warning: (ae-forgotten-export) The symbol "AssetOutcomeUpdatedArg" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    assetOutcomeUpdated({ channelId, assetHolderAddress, externalPayouts, }: AssetOutcomeUpdatedArg): Promise<void>;
    // Warning: (ae-forgotten-export) The symbol "ChainServiceInterface" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    chainService: ChainServiceInterface;
    challenge(channelId: string): Promise<SingleChannelOutput>;
    // Warning: (ae-forgotten-export) The symbol "ChallengeRegisteredArg" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    challengeRegistered(arg: ChallengeRegisteredArg): Promise<void>;
    // Warning: (ae-forgotten-export) The symbol "ChannelFinalizedArg" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    channelFinalized(arg: ChannelFinalizedArg): Promise<void>;
    closeChannel({ channelId, }: CloseChannelParams): Promise<SingleChannelOutput & {
        newObjective: WalletObjective;
    }>;
    closeChannels(channelIds: Bytes32[]): Promise<MultipleChannelOutput>;
    // (undocumented)
    static create(engineConfig: IncomingEngineConfig): Promise<SingleThreadedEngine>;
    createChannel(args: CreateChannelParams): Promise<SingleChannelOutput & {
        newObjective: WalletObjective;
    }>;
    createChannels(args: CreateChannelParams, numberOfChannels: number): Promise<MultipleChannelOutput>;
    createLedgerChannel(args: Pick<CreateChannelParams, 'participants' | 'allocations' | 'challengeDuration'>, fundingStrategy?: 'Direct' | 'Fake'): Promise<SingleChannelOutput>;
    destroy(): Promise<void>;
    // (undocumented)
    readonly engineConfig: EngineConfig;
    getApprovedObjectives(): Promise<WalletObjective[]>;
    getChannels(): Promise<MultipleChannelOutput>;
    getLedgerChannels(assetHolderAddress: string, participants: Participant_2[]): Promise<MultipleChannelOutput>;
    getObjective(objectiveId: string): Promise<WalletObjective>;
    getSigningAddress(): Promise<Address>;
    getState({ channelId }: GetStateParams): Promise<SingleChannelOutput>;
    // Warning: (ae-forgotten-export) The symbol "HoldingUpdatedArg" needs to be exported by the entry point index.d.ts
    // Warning: (ae-forgotten-export) The symbol "EngineResponse" needs to be exported by the entry point index.d.ts
    holdingUpdated({ channelId, amount, assetHolderAddress }: HoldingUpdatedArg, response?: EngineResponse): Promise<SingleChannelOutput>;
    joinChannel({ channelId }: JoinChannelParams): Promise<SingleChannelOutput>;
    joinChannels(channelIds: ChannelId[]): Promise<MultipleChannelOutput>;
    // (undocumented)
    knex: Knex;
    // Warning: (ae-forgotten-export) The symbol "LedgerManager" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    ledgerManager: LedgerManager;
    // (undocumented)
    logger: Logger;
    // Warning: (ae-forgotten-export) The symbol "ObjectiveManager" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    objectiveManager: ObjectiveManager;
    pushMessage(rawPayload: unknown): Promise<MultipleChannelOutput>;
    pushUpdate(rawPayload: unknown): Promise<SingleChannelOutput>;
    registerAppBytecode(appDefinition: string, bytecode: string): Promise<void>;
    registerAppDefinition(appDefinition: string): Promise<void>;
    // Warning: (ae-forgotten-export) The symbol "Store" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    store: Store;
    syncChannel({ channelId }: SyncChannelParams): Promise<SingleChannelOutput>;
    syncChannels(channelIds: Bytes32[]): Promise<MultipleChannelOutput>;
    syncObjectives(objectiveIds: string[]): Promise<SyncObjectiveResult>;
    updateChannel({ channelId, allocations, appData, }: UpdateChannelParams): Promise<SingleChannelOutput>;
}

// @public (undocumented)
export type SyncObjectiveResult = {
    messagesByObjective: Record<string, WireMessage[]>;
    outbox: Outgoing[];
};

// @public (undocumented)
export function validateEngineConfig(config: Record<string, any>): {
    valid: boolean;
    value: EngineConfig | undefined;
    errors: ValidationErrorItem[];
};

// @public (undocumented)
export class Wallet extends EventEmitter<ObjectiveProposed> {
    approveObjectives(objectiveIds: string[]): Promise<ObjectiveResult[]>;
    closeChannels(channelIds: string[]): Promise<ObjectiveResult[]>;
    // Warning: (ae-forgotten-export) The symbol "MessageServiceFactory" needs to be exported by the entry point index.d.ts
    static create(engine: Engine, messageServiceFactory: MessageServiceFactory, retryOptions?: Partial<RetryOptions>): Promise<Wallet>;
    createChannels(channelParameters: CreateChannelParams[]): Promise<ObjectiveResult[]>;
    // (undocumented)
    destroy(): Promise<void>;
    jumpStartObjectives(): Promise<ObjectiveResult[]>;
    // Warning: (ae-forgotten-export) The symbol "MessageServiceInterface" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    get messageService(): MessageServiceInterface;
    }


// Warnings were encountered during analysis:
//
// src/engine/types.ts:24:3 - (ae-forgotten-export) The symbol "WireMessage" needs to be exported by the entry point index.d.ts
// src/engine/types.ts:68:39 - (ae-forgotten-export) The symbol "WalletObjective" needs to be exported by the entry point index.d.ts
// src/wallet/types.ts:53:3 - (ae-forgotten-export) The symbol "ObjectiveStatus" needs to be exported by the entry point index.d.ts

// (No @packageDocumentation comment for this package)

```
